{% extends "soakdb_template.html" %}
  
{% block head_links %}
<!-- <link rel="stylesheet" href="../../static/compound_screen/table_layout.css"> -->
<link rel="stylesheet" href="../../static/compound_screen/batches.css">
<script src="../../static/compound_screen/batches.js"></script>
<script src="../../static/compound_screen/batches-functions.js"></script>
<script src="../../static/compound_screen/batches-classes-consts.js"></script>
<script src="../../static/compound_screen/batches-helpers.js"></script>

<script src="../../static/functions.js"></script>
<script src="../../static/classes.js"></script>
{% endblock %}

{% block main %}
<div id="source">
	<h2>Summary</h2>
		<table>
		<caption>Library plates</caption>
		<thead>
			<tr>
				<th>Library</th>
				<th>Plate</th>
				<th>Compounds <br>in screen</th>
				<th class="unused-compounds">Unused</th>
			</tr>
		</thead>
		<tbody>
			{% for i, j, k  in libraries%}
			<tr class="lib-row">
				<td class="lib-name">{{ i }}</td>
				<td class="lib-plate">{{ j }}</td>
				<td class="compounds-number">{{ k }}</td>
				<td class="unused-compounds"></td>
			</tr>
			{% endfor %}
		</tbody>
		<tfoot>
			<tr>
				<td colspan="2"><strong>Total:</strong></td>
				<td id="total-compounds"></td>
			</tr>
		</tfoot>
	</table>
<br><br>
	<table>
		<caption>Crystallisation plates</caption>
		<thead>
			<tr>
				<th>Plate ID</th>
				<th>Accepted <br>crystals</th>
				<th class="unused-crystals">Unused</th>
			</tr>
		</thead>
		<tbody>
			{% for i, j  in crystal_plates%}
			<tr class="crystal-row">
				<td class="cr-plate-name">{{ i }}</td>
				<td class="crystals-number">{{ j }}</td>
				<td class="unused-crystals"></td>
			</tr>
			{% endfor %}
		</tbody>
		<tfoot>
			<tr>
				<td><strong>Total:</strong></td>
				<td id="total-crystals"></td>
				<td id="total-unused-crystals" class="unused-crystals"></td>
			</tr>
		</tfoot>
	</table>
</div>


<div>
	<form class="view2">
		<label id="divide">Specify batch size:</label>
		<br>
		<input type="radio" name="batch-making-method" id="one-per-match" value="one-per-match" checked>
		<label for="one-per-match">1 batch per plate </label>
		<input type="radio" name="batch-making-method" id="by-number-of-crystals" value="by-number-of-crystals" >
		<label for="number-of-crystals"><input id="number-of-crystals" type="number" min="1"> crystals per plate</label>
	</form>
	<table id="batch-table">
		<caption>
			<span class="view1">Match crystallisation plates to library plates</span>
			<span class="view2" hidden>Create batches</span>
			<span class="view3" hidden>Batches</span>
		</caption>
		<thead>
			<tr>
				<th class="lib-plate">Library (source) <br>plate</th>

				<th class="wells" >Wells<br><br><button class="in-table" id="hide-well">Hide</button></th>
				<th class="cr-plate">Crystallisation <br> (destination) plate</th>
				<th class="drop" >Drops<br><button class="in-table" id="hide-drop">Hide</button></th>
				<th class="batch">Batch</th>
				<th class="items">Batch size</th>
				<th class="pb-name">PlateBatch Name</th>
				<th class="checkbox-cell">Select<br>to&nbsp;edit</th>
			</tr>
		</thead>
		<tbody id="batches-tbody">
		{% for i, j, k  in libraries%}
			<tr class="batch-row">
				
				<td class="lib-plate" rowspan="1">
					<select class="lib-plate-selection">
						<option value="null">None / reset selection</option>
					</select>
				</td>
				
					
				<td class="wells">TODO</td>
				<td class="cr-plate">
					<select class="cr-plate-selection">
						<option value="null">None  / reset selection</option>
					</select>
				</td>
				<td class="drop">TODO</td>
				<td class="batch"><span class="small">no batch<br>created yet</span></td>
				<td class="items"><span class="small">no batch<br>created yet</span></td>	
				<td class="pb-name">TODO</td>
				<td class="checkbox-cell"><span class="small">not ready</span><!--<input class="batch-checkbox" type="checkbox">--></td>
			</tr>
		{% endfor %} 
		</tbody>
		<tfoot>
			<tr>
				<td id="wide-cell" colspan="4">Total of compounds used in experiment in all plates</td>
				<td id="total-items"></td>
			</tr>
		</tfoot>
	</table>	
	
	<div class="view3" hidden>
		<button>Accept and save</button>
		<div class="nextlink">
		<button>Next step <br> (Soaking)</button>
		<br>
		<span class="comment"> Only works if there is some saved data. <br>
			If data saved is different than data in the spreadshet, asks if <br>
			you want to save changes.</span>
	</div>
</div>
</div>
<div class="view3" id="actions">
	<button id="merge-selected">Merge selected</button>
	<button id="delete-selected">Delete selected</button>
</div>
{% endblock %}
