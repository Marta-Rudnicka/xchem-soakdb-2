{% extends "soakdb_template.html" %}
  
{% block head_links %}
<!-- <link rel="stylesheet" href="../../static/compound_screen/table_layout.css"> -->
<link rel="stylesheet" href="../../static/compound_screen/batches.css">
<script src="../../static/compound_screen/batches.js"></script>
<script src="../../static/compound_screen/batches-functions.js"></script>
<script src="../../static/classes.js"></script>
{% endblock %}

{% block main %}
<div id="source">
	<!--
	<div id="source-lib-plates">
		<h2>Library plates</h2>
			<table>.
				<thead>
				<tr>
					<th>Library</th>
					<th>Plate</th>
					<th>Compounds in screen</th>
					<th>Matched to crystals</th>
					<th>Not matched</th>
				</tr>
			</thead>
			<tbody>
				{% for i, j, k  in libraries%}
				<tr class="lib-row">
					<td class="lib-name">{{ i }}</td>
					<td class="lib-plate">{{ j }}</td>
					<td class="compounds-number">{{ k }}</td>
					<td></td>
					<td></td>
				</tr>
				{% endfor %}
			</tbody>
			<tfoot>
				<tr>
					<td colspan="2"><strong>Total:</strong></td>
					<td id="total-compounds"></td>
				</tr>
			</tfoot>
		</table>
	</div> -->
	<div id="source-cryst-plates">
		<h2>Crystallisation plates</h2>
		<table>
			<thead>
				<tr>
					<th>Plate ID</th>
					<th>Crystals in screen</th>
					<th>Matched to compounds</th>
					<th>Unmatched</th>
				</tr>
			</thead>
			<tbody>
				{% for i, j  in crystal_plates%}
				<tr class="crystal-row">
					<td class="cr-plate-name">{{ i }}</td>
					<td class="crystals-number">{{ j }}</td>
					<td></td>
					<td></td>
				</tr>
				{% endfor %}
			</tbody>
			<tfoot>
				<tr>
					<td><strong>Total:</strong></td>
					<td id="total-crystals"></td>
				</tr>
			</tfoot>
		</table>
	</div>

</div>
<div>
<table id="batch-table">
	<caption>Match crystallisation plates to library plates</caption>
	<thead>
		<tr>
			<th class="batch">Batch</th>
			<th class="crystals">Crystals</th>
			<th class="instructions">Instructions</th>
			<th class="lib">Library</th>
			<th class="lib-plate">Library (source) <br>plate</th>
			<th class="wells" >Wells<br><br><button class="in-table" id="hide-well">Hide</button></th>
			<th class="cr-plate">Crystallisation <br> (destination) plate</th>
			<th class="matches">Matched compounds</th>
			<th class="drop" >Drops<br><button class="in-table" id="hide-drop">Hide</button></th>
			<th class="pb-name">PlateBatch Name</th>
		</tr>
	</thead>
	<tbody id="batches-tbody">
	{% for i, j, k  in libraries%}
				<tr class="batch-row">
					<td class="batch"></td>
					<td class="crystals"></td>
					<td class="instructions">Select the first destination plate for this library plate</td>
					<td class="lib">{{ i }}</td>
					<td class="lib-plate">{{ j }}</td>
					
					<td class="wells"></td>
					<td  class="cr-plate">
						<select class="cr-plate-selection">
							<option value="null">Select plate</option>
						</select>
						<button class="ok-button">OK</button><br>
						<div class="tip"></div>
					</td>
					<td class="matches"><span class="missing-matches">{{ k }}</span> matches<br>to make</td>
					<td class="drop"></td>
					<td class="pb-name"></td>
				</tr>
	{% endfor %}
	</tbody>
	<tfoot>
		<tr>
			<td colspan="4">Total of compounds used in experiment in all plates</td>
			<td id="total-compounds"></td>
		</tr>
	</tfoot>
	</table>
				<form>
					<label id="divide">Create batches:</label>
					<br>
					<input type="radio" name="batch-making-method" id="one-per-match" value="one-per-match">
						<label for="one-per-match">1 batch for each library plate - crystallisation plate match</label>
					<br>
					<input type="radio" name="batch-making-method" id="by-number-of-crystals" value="by-number-of-crystals">
						<label for="number-of-crystals"> <input id="number-of-crystals" type="number" min="1"> crystals per batch</label>
					<br>
					<input type="radio" name="batch-making-method" id="other" value="other">
						<label for="other">other ????</label>
					<br>
					<button id="create-batches">Submit</button>
				</form>
				
				<div>
					<button>Accept and save</button>
				</div>
				<div class="nextlink">
					<button>Next step <br> (Soaking)</button>
					<br>
					<span class="comment"> Only works if there is some saved data. <br>
					If data saved is different than data in the spreadshet, asks if <br>
					you want to save changes.</span>
				</div>
			</div>
{% endblock %}
